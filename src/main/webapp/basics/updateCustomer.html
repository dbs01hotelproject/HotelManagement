<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>修改用户</title>
		<link rel="stylesheet" href="../layui/css/layui.css" media="all">
		<link href="../css/common.css" rel="stylesheet" />
		<style>
			td{
				text-align: center;
			}
		</style>
	</head>
	<body>
		<table class="layui-table">
			<thead>
				<tr>
					<th style="text-align: center;" colspan="3">个人信息</th>
				</tr>
			</thead>
			<tbody id="datalist" lay-filter="test">
				<tr>
					<td>用户名：</td>
					<td colspan="2"><input id="user_name" class="layui-input" type="text"/></td>
				</tr>
				<tr>
					<td>登录名：</td>
					<td colspan="2"><input id="user_name" class="layui-input" type="text"/></td>
				</tr>
				<tr>
					<td>密码：</td>
					<td colspan="2"><input id="user_password" class="layui-input" type="password"/></td>
				</tr>
				<tr>
					<td>联系方式：</td>
					<td colspan="2"><input id="user_phone" class="layui-input" type="tel" /></td>
				</tr>
				<tr>
					<td>用户类型</td>
					<td colspan="2">
						<div class="layui-input-inline">
							<select id="flg" name="" lay-verify="" class="layui-select">
								<option value="">全部</option>
								<option value="1">酒店工作人员</option>
								<option value="2">前台街道人员</option>
								<option value="3">房管员</option>
								<option value="4">收银员</option>
								<option value="5">管理员</option>
							</select>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
		<div style="display: flex;justify-content: center;">
			<button class="layui-btn layui-btn-normal" onclick="addAdmin()">添加用户</button>
		</div>
		<script src="../js/jquery-3.3.1.min.js"></script>
		<script src="../layui/layui.all.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/common.js" type="text/javascript"></script>
		<script>
			// 验证非法登录
			//checkLogin();
		</script>
		<script>
			function getData(){
				//用户名
				var user_name = $('#user_name').val().toString().trim();
				//密码
				var user_password = $('#user_password').val().toString().trim();
				//联系方式
				var user_phone = $('#user_phone').val().toString().trim();
				//用户类型
				var flg = $('#flg').val().toString().trim();
				$.ajax({
				    	type:"post",
				    	url:'/ESFWeb/api/addadmin.jsp',
				    	datatype:'json',
				    	data:{
				    		user_name:user_name,
							user_password:user_password,
							user_phone:user_phone,
							flg:flg
				    	},
				    	success:function(data){
				    		//var newData= JSON.parse(data);
							var newData = data
							layer.alert(newData.msg,{
								icon:1,
								closeBtn:0
							},function(index){
								//关闭保存成功页面
								layer.close(index);
								//获得当前页面索引
								var indexmain = parent.layer.getFrameIndex(window.name);
								//触发主页面按钮事件,根据不同业务可以在自己页面中修改方法
								parent.getSearchData()
								parent.layer.close(indexmain)
							})
				    	},
				    	error:function(e){
				    		console.log(e)
							layer.alert(e.msg,{
								icon:5,
								closeBtn:0
							},function(index){
								//关闭保存成功页面
								layer.close(index);
								//获得当前页面索引
								var indexmain = parent.layer.getFrameIndex(window.name);
								//触发主页面按钮事件,根据不同业务可以在自己页面中修改方法
								parent.getSearchData()
								parent.layer.close(indexmain)
				    	})
					}
				});
				
			}
			function addAdmin(){
				//用户名
				var user_name = $('#user_name').val().toString().trim();
				//密码
				var user_password = $('#user_password').val().toString().trim();
				//联系方式
				var user_phone = $('#user_phone').val().toString().trim();
				//用户类型
				var flg = $('#flg').val().toString().trim();
				$.ajax({
				    	type:"post",
				    	url:'/ESFWeb/api/addadmin.jsp',
				    	datatype:'json',
				    	data:{
				    		user_name:user_name,
							user_password:user_password,
							user_phone:user_phone,
							flg:flg
				    	},
				    	success:function(data){
				    		//var newData= JSON.parse(data);
							var newData = data
							layer.alert(newData.msg,{
								icon:1,
								closeBtn:0
							},function(index){
								//关闭保存成功页面
								layer.close(index);
								//获得当前页面索引
								var indexmain = parent.layer.getFrameIndex(window.name);
								//触发主页面按钮事件,根据不同业务可以在自己页面中修改方法
								parent.getSearchData()
								parent.layer.close(indexmain)
							})
				    	},
				    	error:function(e){
				    		console.log(e)
							layer.alert(e.msg,{
								icon:5,
								closeBtn:0
							},function(index){
								//关闭保存成功页面
								layer.close(index);
								//获得当前页面索引
								var indexmain = parent.layer.getFrameIndex(window.name);
								//触发主页面按钮事件,根据不同业务可以在自己页面中修改方法
								parent.getSearchData()
								parent.layer.close(indexmain)
				    	})
					}
				});
				
			}
		</script>
	</body>
</html>
